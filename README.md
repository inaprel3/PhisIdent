# Кваліфікаційна робота магістра 2025 року
## "Інтелектуальна система ідентифікації фішингу"

---

## Опис проекту
Для економії місця, папка з файлами `pkl` була заархівована у zip.  
Для запуску системи слід розархівувати цю папку, відкрити термінал у VS Code і виконати команду:

```bash
python app.py
```

Після цього у браузері відкриється сайт з системою за посиланням: http://127.0.0.1:5000/

Актуальність теми полягає у тому, що фішингові атаки є одними з найпоширеніших видів кіберзлочинів, спрямованих на отримання конфіденційної інформації користувачів шляхом соціальної інженерії та підробки вебресурсів. Щороку кількість таких атак зростає, завдаючи значної шкоди як окремим користувачам, так і великим організаціям. У зв’язку з цим, розробка інтелектуальних систем для автоматичного виявлення фішингових повідомлень та посилань є важливим напрямом підвищення рівня кібербезпеки та запобігання кіберзагрозам.

Розробка інтелектуальної системи ідентифікації фішингових повідомлень та посилань здійснюється з метою підвищення рівня кібербезпеки, своєчасного попередження користувачів про потенційні загрози та зниження ризику несанкціонованого доступу до конфіденційної інформації. Для досягнення поставленої мети використано методи машинного навчання, обробки текстових даних та аналізу URL-адрес.

Об’єктом дослідження є процеси автоматичного виявлення та класифікації фішингових повідомлень у цифрових комунікаційних системах, а також підробних URL-адрес, що використовуються у фішингових атаках. 

Предметом дослідження є алгоритми машинного навчання (Gradient Boosting, Random Forest, Logistic Regression, Support Vector Machine, Naive Bayes) для ідентифікації фішингових повідомлень і посилань на основі аналізу текстових і URL-ознакових характеристик. 

Архітектура розробленої інтелектуальної системи ідентифікації фішингових повідомлень і URL побудована на основі модульного підходу, що забезпечує її гнучкість, масштабованість та зручність у подальшій інтеграції з іншими аналітичними сервісами. Система включає інтерфейс користувача, реалізований засобами HTML, CSS та JavaScript; серверну частину на Flask (Python), яка обробляє запити користувача та виконує класифікацію повідомлень і URL-адрес; модулі попередньої обробки тексту та URL (очищення, визначення мови, переклад, TF-IDF-векторизація); блоки ML, що використовують алгоритми NB, LR, SVM, RF і GB; модуль рекомендацій і зворотного зв’язку, а також сховище даних для моделей і результатів. 

![Схема структури системи](https://github.com/inaprel3/PhisIdent/raw/main/picture/SchemeStructure.png)

## Як працює програма

Інтелектуальна система ідентифікації фішингу реалізована на мові Python із використанням фреймворку Flask, що забезпечує обробку HTTP-запитів, інтеграцію з моделями ML та взаємодію з фронтендом. Основний файл `app.py` керує запуском серверу, маршрутизацією запитів (`/check_message`, `/check_url`, `/feedback`), завантажує натреновані моделі для класифікації текстових повідомлень (LR, Multinomial NB, SVM) та URL-посилань (RF, GB), обробляє введений користувачем текст або URL (перевірка на наявність лише URL, визначення мови, переклад на англійську для коректної роботи моделей, векторизація), формує результати класифікації та рекомендації, обробляє фідбек користувача, а також автоматично відкриває вебінтерфейс у браузері. Додаткові модулі (`messages.py`, `url.py`, `train_kaggle_datasets.py`, `train_recommendation_model.py`) відповідають за підготовку даних, навчання та оцінку моделей, інтегруючи відкриті та кастомні датасети для підвищення точності класифікації, а також формування рекомендацій щодо потенційних фішингових повідомлень та URL. Фронтенд на HTML, CSS та JavaScript забезпечує зручний інтерфейс для введення даних, відображення результатів класифікації, рекомендацій і збору зворотного зв’язку. Всі дані, проміжні результати та навчальні моделі зберігаються у CSV та PKL-файлах, що дозволяє автономну роботу системи офлайн та забезпечує відтворюваність результатів.

Для тестування та оцінки ефективності системи використовувались кілька відкритих і кастомних наборів даних, що включають приклади фішингових і легітимних повідомлень та URL-адрес. Основним джерелом є «Phishing Dataset» із Hugging Face (https://huggingface.co/datasets/ealvaradob/phishing-dataset), який містить піднабори Mail (≈18 000 email), SMS (≈5 971 повідомлення), URL (≈800 000 адрес) та Website (≈80 000 вебсторінок), усі дані попередньо очищені, збалансовані та структуровані у два стовпці: «text» і «label»; для навчання моделей рекомендується скорочена версія «combined reduced». Для локалізації та підвищення точності системи були створені власні файли «custom_messages.csv» і «custom_urls.csv», що включають англомовні та україномовні повідомлення, а також легітимні та фішингові URL із реальних прикладів атак і популярних сервісів. Додатково використовувалися набори з Kaggle: «Phishing Email Dataset» (https://www.kaggle.com/datasets/naserabdullahalam/phishing-email-dataset?select=phishing_email.csv), що містить понад 82 000 email із різних джерел для навчання текстових моделей, та «Phishing URL Classifier Dataset Cleaned» (https://www.kaggle.com/datasets/adityachaudhary1306/phishing-url-classifier-dataset-cleaned) із близько 11 000 URL для класифікації на основі структурних ознак. Комбінація цих джерел забезпечує репрезентативність, баланс класів, різноманітність форматів і мов, що підвищує точність, узагальнюваність і надійність системи.

Фронтенд системи виявлення фішингових повідомлень і посилань реалізований через вебінтерфейс із використанням HTML, CSS та JavaScript і забезпечує інтуїтивно зрозумілу взаємодію користувача з моделями ML у режимі реального часу. Головна сторінка містить дві форми для перевірки текстових повідомлень та URL-адрес із полем введення, кнопкою «Перевірити» та блоком результатів, де відображається висновок моделі у форматі JSON. Для швидкого сприйняття рівня загрози застосовується кольорова система індикаторів: зелений – безпечне, червоний – фішингове, жовтий – потребує додаткової перевірки. Під результатом надаються рекомендації щодо подальших дій, а користувач може залишити фідбек для покращення рекомендаційного компонента. Додатково передбачені спливаючі підказки та повідомлення про помилки введення для підвищення юзабіліті. Типовий сценарій роботи: користувач вводить текст або URL → натискає «Перевірити» → бекенд класифікує об’єкт → результат із рівнем ризику та порадами відображається на фронтенді, що робить процес перевірки простим, наочним і зручним навіть для некваліфікованих користувачів.

Головна сторінка системи у браузері:
![](https://github.com/inaprel3/PhisIdent/blob/main/picture/System%20home%20page%20in%20browser.png)

Безпечні повідомлення та посилання:
![](https://github.com/inaprel3/PhisIdent/blob/main/picture/Secure%20messages%20and%20links.png)

Небезпечні повідомлення та посилання:
![](https://github.com/inaprel3/PhisIdent/blob/main/picture/Dangerous%20messages%20and%20links.png)

Пусті поля для введення повідомлень і посилань:
![](https://github.com/inaprel3/PhisIdent/blob/main/picture/Empty%20fields%20for%20entering%20messages%20and%20links.png)

### Результати роботи моделей ML

#### Класифікація повідомлень (SMS + Email + Custom)

| Модель                  | Клас            | Precision | Recall | F1-score | Support |
|--------------------------|----------------|-----------|--------|----------|---------|
| **Naive Bayes (NB)**     | 0 (безпечні)   | 0.96      | 0.96   | 0.96     | 2496    |
|                          | 1 (фішинг)     | 0.93      | 0.94   | 0.93     | 1539    |
|                          | **accuracy**   |           |        | 0.95     | 4035    |
| **Logistic Regression**  | 0              | 0.96      | 0.97   | 0.96     | 2496    |
|                          | 1              | 0.96      | 0.93   | 0.94     | 1539    |
|                          | **accuracy**   |           |        | 0.96     | 4035    |
| **Support Vector Machine (SVM)** | 0        | 0.97      | 0.98   | 0.97     | 2496    |
|                          | 1              | 0.96      | 0.94   | 0.95     | 1539    |
|                          | **accuracy**   |           |        | 0.96     | 4035    |

#### Класифікація URL (Main + Custom)

| Модель                  | Клас            | Precision | Recall | F1-score | Support |
|--------------------------|----------------|-----------|--------|----------|---------|
| **Random Forest (RF)**   | 0 (безпечні)   | 0.97      | 0.98   | 0.97     | 89053   |
|                          | 1 (фішинг)     | 0.97      | 0.96   | 0.97     | 78093   |
|                          | **accuracy**   |           |        | 0.97     | 167146  |
| **Gradient Boosting (GB)** | 0            | 0.90      | 0.93   | 0.92     | 89053   |
|                          | 1              | 0.92      | 0.88   | 0.90     | 78093   |
|                          | **accuracy**   |           |        | 0.91     | 167146  |

#### Класифікація Kaggle datasets

**Phishing Email Dataset (recommendation model):**

| Категорія                  | Precision | Recall | F1-score | Support |
|-----------------------------|-----------|--------|----------|---------|
| account_blocked             | 1.00      | 0.67   | 0.80     | 55      |
| default                     | 0.93      | 0.98   | 0.95     | 5069    |
| payment_alert               | 0.93      | 0.38   | 0.54     | 113     |
| request_click_link          | 0.98      | 0.92   | 0.95     | 2237    |
| request_personal_data       | 0.82      | 0.79   | 0.80     | 1105    |
| **accuracy**                |           |        | 0.93     | 8579    |

**Phishing URL Dataset (Kaggle):**

| Модель                  | Клас            | Precision | Recall | F1-score | Support |
|--------------------------|----------------|-----------|--------|----------|---------|
| Random Forest (RF)       | 0              | 0.98      | 0.96   | 0.97     | 980     |
|                          | 1              | 0.97      | 0.98   | 0.98     | 1231    |
|                          | **accuracy**   |           |        | 0.97     | 2211    |
| Gradient Boosting (GB)   | 0              | 0.95      | 0.94   | 0.95     | 980     |
|                          | 1              | 0.95      | 0.96   | 0.96     | 1231    |
|                          | **accuracy**   |           |        | 0.95     | 2211    |

#### Recommendation model (Custom + SMS + Email)

| Категорія                  | Precision | Recall | F1-score | Support |
|-----------------------------|-----------|--------|----------|---------|
| account_blocked             | 0.00      | 0.00   | 0.00     | 4       |
| default                     | 0.84      | 0.83   | 0.83     | 879     |
| payment_alert               | 1.00      | 0.10   | 0.17     | 21      |
| request_click_link          | 0.91      | 0.82   | 0.87     | 418     |
| request_personal_data       | 0.83      | 0.57   | 0.68     | 217     |
| safe                        | 0.93      | 0.99   | 0.96     | 2496    |
| **accuracy**                |           |        | 0.91     | 4035    |
